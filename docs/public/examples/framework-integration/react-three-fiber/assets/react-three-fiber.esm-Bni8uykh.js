import{R as He,O as lt,P as ut,S as ft,a as ie,V as dt,b as pt,B as vt,N as ht,A as mt,L as se,c as gt,U as wt,d as Ie,e as J,W as yt,C as bt,f as _t,T as Et}from"./three.module-BpFRX8OQ.js";import{r as _,R as Ct,c as G,j as A,s as Pt,a as Ee,b as Be,p as St,d as Mt}from"./index-CLWqF8v3.js";function Ce(e,t){let n;return(...i)=>{window.clearTimeout(n),n=window.setTimeout(()=>e(...i),t)}}function xt({debounce:e,scroll:t,polyfill:n,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const a=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!a)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[v,w]=_.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),d=_.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:v,orientationHandler:null}),p=e?typeof e=="number"?e:e.scroll:null,h=e?typeof e=="number"?e:e.resize:null,r=_.useRef(!1);_.useEffect(()=>(r.current=!0,()=>void(r.current=!1)));const[o,f,c]=_.useMemo(()=>{const s=()=>{if(!d.current.element)return;const{left:u,top:m,width:E,height:C,bottom:P,right:x,x:j,y:O}=d.current.element.getBoundingClientRect(),S={left:u,top:m,width:E,height:C,bottom:P,right:x,x:j,y:O};d.current.element instanceof HTMLElement&&i&&(S.height=d.current.element.offsetHeight,S.width=d.current.element.offsetWidth),Object.freeze(S),r.current&&!Tt(d.current.lastBounds,S)&&w(d.current.lastBounds=S)};return[s,h?Ce(s,h):s,p?Ce(s,p):s]},[w,i,p,h]);function l(){d.current.scrollContainers&&(d.current.scrollContainers.forEach(s=>s.removeEventListener("scroll",c,!0)),d.current.scrollContainers=null),d.current.resizeObserver&&(d.current.resizeObserver.disconnect(),d.current.resizeObserver=null),d.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",d.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",d.current.orientationHandler))}function y(){d.current.element&&(d.current.resizeObserver=new a(c),d.current.resizeObserver.observe(d.current.element),t&&d.current.scrollContainers&&d.current.scrollContainers.forEach(s=>s.addEventListener("scroll",c,{capture:!0,passive:!0})),d.current.orientationHandler=()=>{c()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",d.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",d.current.orientationHandler))}const g=s=>{!s||s===d.current.element||(l(),d.current.element=s,d.current.scrollContainers=Ne(s),y())};return Rt(c,!!t),Ot(f),_.useEffect(()=>{l(),y()},[t,c,f]),_.useEffect(()=>l,[]),[g,v,o]}function Ot(e){_.useEffect(()=>{const t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function Rt(e,t){_.useEffect(()=>{if(t){const n=e;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[e,t])}function Ne(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:i,overflowY:a}=window.getComputedStyle(e);return[n,i,a].some(v=>v==="auto"||v==="scroll")&&t.push(e),[...t,...Ne(e.parentElement)]}const jt=["x","y","top","bottom","left","right","width","height"],Tt=(e,t)=>jt.every(n=>e[n]===t[n]);var zt=Object.defineProperty,Lt=Object.defineProperties,At=Object.getOwnPropertyDescriptors,Pe=Object.getOwnPropertySymbols,kt=Object.prototype.hasOwnProperty,Dt=Object.prototype.propertyIsEnumerable,Se=(e,t,n)=>t in e?zt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Me=(e,t)=>{for(var n in t||(t={}))kt.call(t,n)&&Se(e,n,t[n]);if(Pe)for(var n of Pe(t))Dt.call(t,n)&&Se(e,n,t[n]);return e},Ft=(e,t)=>Lt(e,At(t)),xe,Oe;typeof window<"u"&&((xe=window.document)!=null&&xe.createElement||((Oe=window.navigator)==null?void 0:Oe.product)==="ReactNative")?_.useLayoutEffect:_.useEffect;function qe(e,t,n){if(!e)return;if(n(e)===!0)return e;let i=e.child;for(;i;){const a=qe(i,t,n);if(a)return a;i=i.sibling}}function Ge(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const Re=console.error;console.error=function(){const e=[...arguments].join("");if(e!=null&&e.startsWith("Warning:")&&e.includes("useContext")){console.error=Re;return}return Re.apply(this,arguments)};const ge=Ge(_.createContext(null));class Ue extends _.Component{render(){return _.createElement(ge.Provider,{value:this._reactInternals},this.props.children)}}function Ht(){const e=_.useContext(ge);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=_.useId();return _.useMemo(()=>{for(const i of[e,e==null?void 0:e.alternate]){if(!i)continue;const a=qe(i,!1,v=>{let w=v.memoizedState;for(;w;){if(w.memoizedState===t)return!0;w=w.next}});if(a)return a}},[e,t])}function It(){const e=Ht(),[t]=_.useState(()=>new Map);t.clear();let n=e;for(;n;){if(n.type&&typeof n.type=="object"){const a=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;a&&a!==ge&&!t.has(a)&&t.set(a,_.useContext(Ge(a)))}n=n.return}return t}function Bt(){const e=It();return _.useMemo(()=>Array.from(e.keys()).reduce((t,n)=>i=>_.createElement(t,null,_.createElement(n.Provider,Ft(Me({},i),{value:e.get(n)}))),t=>_.createElement(Ue,Me({},t))),[e])}var ar=Object.freeze({__proto__:null});const we={},Nt=e=>void Object.assign(we,e);function qt(e,t){function n(r,{args:o=[],attach:f,...c},l){let y=`${r[0].toUpperCase()}${r.slice(1)}`,g;if(r==="primitive"){if(c.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const s=c.object;g=N(s,{type:r,root:l,attach:f,primitive:!0})}else{const s=we[y];if(!s)throw new Error(`R3F: ${y} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(o))throw new Error("R3F: The args prop must be an array!");g=N(new s(...o),{type:r,root:l,attach:f,memoizedProps:{args:o}})}return g.__r3f.attach===void 0&&(g.isBufferGeometry?g.__r3f.attach="geometry":g.isMaterial&&(g.__r3f.attach="material")),y!=="inject"&&le(g,c),g}function i(r,o){let f=!1;if(o){var c,l;(c=o.__r3f)!=null&&c.attach?ce(r,o,o.__r3f.attach):o.isObject3D&&r.isObject3D&&(r.add(o),f=!0),f||(l=r.__r3f)==null||l.objects.push(o),o.__r3f||N(o,{}),o.__r3f.parent=r,me(o),q(o)}}function a(r,o,f){let c=!1;if(o){var l,y;if((l=o.__r3f)!=null&&l.attach)ce(r,o,o.__r3f.attach);else if(o.isObject3D&&r.isObject3D){o.parent=r,o.dispatchEvent({type:"added"}),r.dispatchEvent({type:"childadded",child:o});const g=r.children.filter(u=>u!==o),s=g.indexOf(f);r.children=[...g.slice(0,s),o,...g.slice(s)],c=!0}c||(y=r.__r3f)==null||y.objects.push(o),o.__r3f||N(o,{}),o.__r3f.parent=r,me(o),q(o)}}function v(r,o,f=!1){r&&[...r].forEach(c=>w(o,c,f))}function w(r,o,f){if(o){var c,l,y;if(o.__r3f&&(o.__r3f.parent=null),(c=r.__r3f)!=null&&c.objects&&(r.__r3f.objects=r.__r3f.objects.filter(E=>E!==o)),(l=o.__r3f)!=null&&l.attach)Ae(r,o,o.__r3f.attach);else if(o.isObject3D&&r.isObject3D){var g;r.remove(o),(g=o.__r3f)!=null&&g.root&&$t(ne(o),o)}const u=(y=o.__r3f)==null?void 0:y.primitive,m=!u&&(f===void 0?o.dispose!==null:f);if(!u){var s;v((s=o.__r3f)==null?void 0:s.objects,o,m),v(o.children,o,m)}if(delete o.__r3f,m&&o.dispose&&o.type!=="Scene"){const E=()=>{try{o.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?Ee.unstable_scheduleCallback(Ee.unstable_IdlePriority,E):E()}q(r)}}function d(r,o,f,c){var l;const y=(l=r.__r3f)==null?void 0:l.parent;if(!y)return;const g=n(o,f,r.__r3f.root);if(r.children){for(const s of r.children)s.__r3f&&i(g,s);r.children=r.children.filter(s=>!s.__r3f)}r.__r3f.objects.forEach(s=>i(g,s)),r.__r3f.objects=[],r.__r3f.autoRemovedBeforeAppend||w(y,r),g.parent&&(g.__r3f.autoRemovedBeforeAppend=!0),i(y,g),g.raycast&&g.__r3f.eventCount&&ne(g).getState().internal.interaction.push(g),[c,c.alternate].forEach(s=>{s!==null&&(s.stateNode=g,s.ref&&(typeof s.ref=="function"?s.ref(g):s.ref.current=g))})}const p=()=>{};return{reconciler:Ct({createInstance:n,removeChild:w,appendChild:i,appendInitialChild:i,insertBefore:a,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(r,o)=>{if(!o)return;const f=r.getState().scene;f.__r3f&&(f.__r3f.root=r,i(f,o))},removeChildFromContainer:(r,o)=>{o&&w(r.getState().scene,o)},insertInContainerBefore:(r,o,f)=>{if(!o||!f)return;const c=r.getState().scene;c.__r3f&&a(c,o,f)},getRootHostContext:()=>null,getChildHostContext:r=>r,finalizeInitialChildren(r){var o;return!!((o=r==null?void 0:r.__r3f)!=null?o:{}).handlers},prepareUpdate(r,o,f,c){var l;if(((l=r==null?void 0:r.__r3f)!=null?l:{}).primitive&&c.object&&c.object!==r)return[!0];{const{args:g=[],children:s,...u}=c,{args:m=[],children:E,...C}=f;if(!Array.isArray(g))throw new Error("R3F: the args prop must be an array!");if(g.some((x,j)=>x!==m[j]))return[!0];const P=Qe(r,u,C,!0);return P.changes.length?[!1,P]:null}},commitUpdate(r,[o,f],c,l,y,g){o?d(r,c,y,g):le(r,f)},commitMount(r,o,f,c){var l;const y=(l=r.__r3f)!=null?l:{};r.raycast&&y.handlers&&y.eventCount&&ne(r).getState().internal.interaction.push(r)},getPublicInstance:r=>r,prepareForCommit:()=>null,preparePortalMount:r=>N(r.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(r){var o;const{attach:f,parent:c}=(o=r.__r3f)!=null?o:{};f&&c&&Ae(c,r,f),r.isObject3D&&(r.visible=!1),q(r)},unhideInstance(r,o){var f;const{attach:c,parent:l}=(f=r.__r3f)!=null?f:{};c&&l&&ce(l,r,c),(r.isObject3D&&o.visible==null||o.visible)&&(r.visible=!0),q(r)},createTextInstance:p,hideTextInstance:p,unhideTextInstance:p,getCurrentEventPriority:()=>t?t():G.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&M.fun(performance.now)?performance.now:M.fun(Date.now)?Date.now:()=>0,scheduleTimeout:M.fun(setTimeout)?setTimeout:void 0,cancelTimeout:M.fun(clearTimeout)?clearTimeout:void 0}),applyProps:le}}var je,Te;const ae=e=>"colorSpace"in e||"outputColorSpace"in e,We=()=>{var e;return(e=we.ColorManagement)!=null?e:null},Ve=e=>e&&e.isOrthographicCamera,Gt=e=>e&&e.hasOwnProperty("current"),V=typeof window<"u"&&((je=window.document)!=null&&je.createElement||((Te=window.navigator)==null?void 0:Te.product)==="ReactNative")?_.useLayoutEffect:_.useEffect;function Xe(e){const t=_.useRef(e);return V(()=>void(t.current=e),[e]),t}function Ut({set:e}){return V(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class $e extends _.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}$e.getDerivedStateFromError=()=>({error:!0});const Ye="__default",ze=new Map,Wt=e=>e&&!!e.memoized&&!!e.changes;function Ke(e){var t;const n=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}const Y=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()};function ne(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const M={obj:e=>e===Object(e)&&!M.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:i="reference",strict:a=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(M.str(e)||M.num(e)||M.boo(e))return e===t;const v=M.obj(e);if(v&&i==="reference")return e===t;const w=M.arr(e);if(w&&n==="reference")return e===t;if((w||v)&&e===t)return!0;let d;for(d in e)if(!(d in t))return!1;if(v&&n==="shallow"&&i==="shallow"){for(d in a?t:e)if(!M.equ(e[d],t[d],{strict:a,objects:"reference"}))return!1}else for(d in a?t:e)if(e[d]!==t[d])return!1;if(M.und(d)){if(w&&e.length===0&&t.length===0||v&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function Je(e){const t={nodes:{},materials:{}};return e&&e.traverse(n=>{n.name&&(t.nodes[n.name]=n),n.material&&!t.materials[n.material.name]&&(t.materials[n.material.name]=n.material)}),t}function Vt(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function N(e,t){const n=e;return n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function he(e,t){let n=e;if(t.includes("-")){const i=t.split("-"),a=i.pop();return n=i.reduce((v,w)=>v[w],e),{target:n,key:a}}else return{target:n,key:t}}const Le=/-\d+$/;function ce(e,t,n){if(M.str(n)){if(Le.test(n)){const v=n.replace(Le,""),{target:w,key:d}=he(e,v);Array.isArray(w[d])||(w[d]=[])}const{target:i,key:a}=he(e,n);t.__r3f.previousAttach=i[a],i[a]=t}else t.__r3f.previousAttach=n(e,t)}function Ae(e,t,n){var i,a;if(M.str(n)){const{target:v,key:w}=he(e,n),d=t.__r3f.previousAttach;d===void 0?delete v[w]:v[w]=d}else(i=t.__r3f)==null||i.previousAttach==null||i.previousAttach(e,t);(a=t.__r3f)==null||delete a.previousAttach}function Qe(e,{children:t,key:n,ref:i,...a},{children:v,key:w,ref:d,...p}={},h=!1){const r=e.__r3f,o=Object.entries(a),f=[];if(h){const l=Object.keys(p);for(let y=0;y<l.length;y++)a.hasOwnProperty(l[y])||o.unshift([l[y],Ye+"remove"])}o.forEach(([l,y])=>{var g;if((g=e.__r3f)!=null&&g.primitive&&l==="object"||M.equ(y,p[l]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(l))return f.push([l,y,!0,[]]);let s=[];l.includes("-")&&(s=l.split("-")),f.push([l,y,!1,s]);for(const u in a){const m=a[u];u.startsWith(`${l}-`)&&f.push([u,m,!1,u.split("-")])}});const c={...a};return r!=null&&r.memoizedProps&&r!=null&&r.memoizedProps.args&&(c.args=r.memoizedProps.args),r!=null&&r.memoizedProps&&r!=null&&r.memoizedProps.attach&&(c.attach=r.memoizedProps.attach),{memoized:c,changes:f}}function le(e,t){var n;const i=e.__r3f,a=i==null?void 0:i.root,v=a==null||a.getState==null?void 0:a.getState(),{memoized:w,changes:d}=Wt(t)?t:Qe(e,t),p=i==null?void 0:i.eventCount;e.__r3f&&(e.__r3f.memoizedProps=w);for(let f=0;f<d.length;f++){let[c,l,y,g]=d[f];if(ae(e)){const E="srgb",C="srgb-linear";c==="encoding"?(c="colorSpace",l=l===3001?E:C):c==="outputEncoding"&&(c="outputColorSpace",l=l===3001?E:C)}let s=e,u=s[c];if(g.length&&(u=g.reduce((m,E)=>m[E],e),!(u&&u.set))){const[m,...E]=g.reverse();s=E.reverse().reduce((C,P)=>C[P],e),c=m}if(l===Ye+"remove")if(s.constructor){let m=ze.get(s.constructor);m||(m=new s.constructor,ze.set(s.constructor,m)),l=m[c]}else l=0;if(y&&i)l?i.handlers[c]=l:delete i.handlers[c],i.eventCount=Object.keys(i.handlers).length;else if(u&&u.set&&(u.copy||u instanceof se)){if(Array.isArray(l))u.fromArray?u.fromArray(l):u.set(...l);else if(u.copy&&l&&l.constructor&&u.constructor===l.constructor)u.copy(l);else if(l!==void 0){var h;const m=(h=u)==null?void 0:h.isColor;!m&&u.setScalar?u.setScalar(l):u instanceof se&&l instanceof se?u.mask=l.mask:u.set(l),!We()&&v&&!v.linear&&m&&u.convertSRGBToLinear()}}else{var r;if(s[c]=l,(r=s[c])!=null&&r.isTexture&&s[c].format===gt&&s[c].type===wt&&v){const m=s[c];ae(m)&&ae(v.gl)?m.colorSpace=v.gl.outputColorSpace:m.encoding=v.gl.outputEncoding}}q(e)}if(i&&i.parent&&e.raycast&&p!==i.eventCount){const f=ne(e).getState().internal,c=f.interaction.indexOf(e);c>-1&&f.interaction.splice(c,1),i.eventCount&&f.interaction.push(e)}return!(d.length===1&&d[0][0]==="onUpdate")&&d.length&&(n=e.__r3f)!=null&&n.parent&&me(e),e}function q(e){var t,n;const i=(t=e.__r3f)==null||(n=t.root)==null||n.getState==null?void 0:n.getState();i&&i.internal.frames===0&&i.invalidate()}function me(e){e.onUpdate==null||e.onUpdate(e)}function Ze(e,t){e.manual||(Ve(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function te(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Xt(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return G.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return G.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return G.ContinuousEventPriority;default:return G.DefaultEventPriority}}function et(e,t,n,i){const a=n.get(t);a&&(n.delete(t),n.size===0&&(e.delete(i),a.target.releasePointerCapture(i)))}function $t(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(i=>i!==t),n.initialHits=n.initialHits.filter(i=>i!==t),n.hovered.forEach((i,a)=>{(i.eventObject===t||i.object===t)&&n.hovered.delete(a)}),n.capturedMap.forEach((i,a)=>{et(n.capturedMap,t,i,a)})}function Yt(e){function t(p){const{internal:h}=e.getState(),r=p.offsetX-h.initialClick[0],o=p.offsetY-h.initialClick[1];return Math.round(Math.sqrt(r*r+o*o))}function n(p){return p.filter(h=>["Move","Over","Enter","Out","Leave"].some(r=>{var o;return(o=h.__r3f)==null?void 0:o.handlers["onPointer"+r]}))}function i(p,h){const r=e.getState(),o=new Set,f=[],c=h?h(r.internal.interaction):r.internal.interaction;for(let s=0;s<c.length;s++){const u=Y(c[s]);u&&(u.raycaster.camera=void 0)}r.previousRoot||r.events.compute==null||r.events.compute(p,r);function l(s){const u=Y(s);if(!u||!u.events.enabled||u.raycaster.camera===null)return[];if(u.raycaster.camera===void 0){var m;u.events.compute==null||u.events.compute(p,u,(m=u.previousRoot)==null?void 0:m.getState()),u.raycaster.camera===void 0&&(u.raycaster.camera=null)}return u.raycaster.camera?u.raycaster.intersectObject(s,!0):[]}let y=c.flatMap(l).sort((s,u)=>{const m=Y(s.object),E=Y(u.object);return!m||!E?s.distance-u.distance:E.events.priority-m.events.priority||s.distance-u.distance}).filter(s=>{const u=te(s);return o.has(u)?!1:(o.add(u),!0)});r.events.filter&&(y=r.events.filter(y,r));for(const s of y){let u=s.object;for(;u;){var g;(g=u.__r3f)!=null&&g.eventCount&&f.push({...s,eventObject:u}),u=u.parent}}if("pointerId"in p&&r.internal.capturedMap.has(p.pointerId))for(let s of r.internal.capturedMap.get(p.pointerId).values())o.has(te(s.intersection))||f.push(s.intersection);return f}function a(p,h,r,o){const f=e.getState();if(p.length){const c={stopped:!1};for(const l of p){const y=Y(l.object)||f,{raycaster:g,pointer:s,camera:u,internal:m}=y,E=new J(s.x,s.y,0).unproject(u),C=S=>{var b,R;return(b=(R=m.capturedMap.get(S))==null?void 0:R.has(l.eventObject))!=null?b:!1},P=S=>{const b={intersection:l,target:h.target};m.capturedMap.has(S)?m.capturedMap.get(S).set(l.eventObject,b):m.capturedMap.set(S,new Map([[l.eventObject,b]])),h.target.setPointerCapture(S)},x=S=>{const b=m.capturedMap.get(S);b&&et(m.capturedMap,l.eventObject,b,S)};let j={};for(let S in h){let b=h[S];typeof b!="function"&&(j[S]=b)}let O={...l,...j,pointer:s,intersections:p,stopped:c.stopped,delta:r,unprojectedPoint:E,ray:g.ray,camera:u,stopPropagation(){const S="pointerId"in h&&m.capturedMap.get(h.pointerId);if((!S||S.has(l.eventObject))&&(O.stopped=c.stopped=!0,m.hovered.size&&Array.from(m.hovered.values()).find(b=>b.eventObject===l.eventObject))){const b=p.slice(0,p.indexOf(l));v([...b,l])}},target:{hasPointerCapture:C,setPointerCapture:P,releasePointerCapture:x},currentTarget:{hasPointerCapture:C,setPointerCapture:P,releasePointerCapture:x},nativeEvent:h};if(o(O),c.stopped===!0)break}}return p}function v(p){const{internal:h}=e.getState();for(const r of h.hovered.values())if(!p.length||!p.find(o=>o.object===r.object&&o.index===r.index&&o.instanceId===r.instanceId)){const f=r.eventObject.__r3f,c=f==null?void 0:f.handlers;if(h.hovered.delete(te(r)),f!=null&&f.eventCount){const l={...r,intersections:p};c.onPointerOut==null||c.onPointerOut(l),c.onPointerLeave==null||c.onPointerLeave(l)}}}function w(p,h){for(let r=0;r<h.length;r++){const o=h[r].__r3f;o==null||o.handlers.onPointerMissed==null||o.handlers.onPointerMissed(p)}}function d(p){switch(p){case"onPointerLeave":case"onPointerCancel":return()=>v([]);case"onLostPointerCapture":return h=>{const{internal:r}=e.getState();"pointerId"in h&&r.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{r.capturedMap.has(h.pointerId)&&(r.capturedMap.delete(h.pointerId),v([]))})}}return function(r){const{onPointerMissed:o,internal:f}=e.getState();f.lastEvent.current=r;const c=p==="onPointerMove",l=p==="onClick"||p==="onContextMenu"||p==="onDoubleClick",g=i(r,c?n:void 0),s=l?t(r):0;p==="onPointerDown"&&(f.initialClick=[r.offsetX,r.offsetY],f.initialHits=g.map(m=>m.eventObject)),l&&!g.length&&s<=2&&(w(r,f.interaction),o&&o(r)),c&&v(g);function u(m){const E=m.eventObject,C=E.__r3f,P=C==null?void 0:C.handlers;if(C!=null&&C.eventCount)if(c){if(P.onPointerOver||P.onPointerEnter||P.onPointerOut||P.onPointerLeave){const x=te(m),j=f.hovered.get(x);j?j.stopped&&m.stopPropagation():(f.hovered.set(x,m),P.onPointerOver==null||P.onPointerOver(m),P.onPointerEnter==null||P.onPointerEnter(m))}P.onPointerMove==null||P.onPointerMove(m)}else{const x=P[p];x?(!l||f.initialHits.includes(E))&&(w(r,f.interaction.filter(j=>!f.initialHits.includes(j))),x(m)):l&&f.initialHits.includes(E)&&w(r,f.interaction.filter(j=>!f.initialHits.includes(j)))}}a(g,r,s,u)}}return{handlePointer:d}}const Kt=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],tt=e=>!!(e!=null&&e.render),ye=_.createContext(null),Jt=(e,t)=>{const n=Be((d,p)=>{const h=new J,r=new J,o=new J;function f(s=p().camera,u=r,m=p().size){const{width:E,height:C,top:P,left:x}=m,j=E/C;u.isVector3?o.copy(u):o.set(...u);const O=s.getWorldPosition(h).distanceTo(o);if(Ve(s))return{width:E/s.zoom,height:C/s.zoom,top:P,left:x,factor:1,distance:O,aspect:j};{const S=s.fov*Math.PI/180,b=2*Math.tan(S/2)*O,R=b*(E/C);return{width:R,height:b,top:P,left:x,factor:E/R,distance:O,aspect:j}}}let c;const l=s=>d(u=>({performance:{...u.performance,current:s}})),y=new Ie;return{set:d,get:p,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(s=1)=>e(p(),s),advance:(s,u)=>t(s,u,p()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new _t,pointer:y,mouse:y,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const s=p();c&&clearTimeout(c),s.performance.current!==s.performance.min&&l(s.performance.min),c=setTimeout(()=>l(p().performance.max),s.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:f},setEvents:s=>d(u=>({...u,events:{...u.events,...s}})),setSize:(s,u,m,E,C)=>{const P=p().camera,x={width:s,height:u,top:E||0,left:C||0,updateStyle:m};d(j=>({size:x,viewport:{...j.viewport,...f(P,r,x)}}))},setDpr:s=>d(u=>{const m=Ke(s);return{viewport:{...u.viewport,dpr:m,initialDpr:u.viewport.initialDpr||m}}}),setFrameloop:(s="always")=>{const u=p().clock;u.stop(),u.elapsedTime=0,s!=="never"&&(u.start(),u.elapsedTime=0),d(()=>({frameloop:s}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:_.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(s,u,m)=>{const E=p().internal;return E.priority=E.priority+(u>0?1:0),E.subscribers.push({ref:s,priority:u,store:m}),E.subscribers=E.subscribers.sort((C,P)=>C.priority-P.priority),()=>{const C=p().internal;C!=null&&C.subscribers&&(C.priority=C.priority-(u>0?1:0),C.subscribers=C.subscribers.filter(P=>P.ref!==s))}}}}}),i=n.getState();let a=i.size,v=i.viewport.dpr,w=i.camera;return n.subscribe(()=>{const{camera:d,size:p,viewport:h,gl:r,set:o}=n.getState();if(p.width!==a.width||p.height!==a.height||h.dpr!==v){var f;a=p,v=h.dpr,Ze(d,p),r.setPixelRatio(h.dpr);const c=(f=p.updateStyle)!=null?f:typeof HTMLCanvasElement<"u"&&r.domElement instanceof HTMLCanvasElement;r.setSize(p.width,p.height,c)}d!==w&&(w=d,o(c=>({viewport:{...c.viewport,...c.viewport.getCurrentViewport(d)}})))}),n.subscribe(d=>e(d)),n};function be(e,t){const n={callback:e};return t.add(n),()=>void t.delete(n)}let re,rt=new Set,nt=new Set,ot=new Set;const cr=e=>be(e,rt),lr=e=>be(e,nt),ur=e=>be(e,ot);function ue(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function K(e,t){switch(e){case"before":return ue(rt,t);case"after":return ue(nt,t);case"tail":return ue(ot,t)}}let fe,de;function pe(e,t,n){let i=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),fe=t.internal.subscribers,re=0;re<fe.length;re++)de=fe[re],de.ref.current(de.store.getState(),i,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function Qt(e){let t=!1,n=!1,i,a,v;function w(h){a=requestAnimationFrame(w),t=!0,i=0,K("before",h),n=!0;for(const o of e.values()){var r;v=o.store.getState(),v.internal.active&&(v.frameloop==="always"||v.internal.frames>0)&&!((r=v.gl.xr)!=null&&r.isPresenting)&&(i+=pe(h,v))}if(n=!1,K("after",h),i===0)return K("tail",h),t=!1,cancelAnimationFrame(a)}function d(h,r=1){var o;if(!h)return e.forEach(f=>d(f.store.getState(),r));(o=h.gl.xr)!=null&&o.isPresenting||!h.internal.active||h.frameloop==="never"||(r>1?h.internal.frames=Math.min(60,h.internal.frames+r):n?h.internal.frames=2:h.internal.frames=1,t||(t=!0,requestAnimationFrame(w)))}function p(h,r=!0,o,f){if(r&&K("before",h),o)pe(h,o,f);else for(const c of e.values())pe(h,c.store.getState());r&&K("after",h)}return{loop:w,invalidate:d,advance:p}}function fr(e){const t=_.useRef(null);return V(()=>void(t.current=e.current.__r3f),[e]),t}function _e(){const e=_.useContext(ye);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function dr(e=n=>n,t){return _e()(e,t)}function pr(e,t=0){const n=_e(),i=n.getState().internal.subscribe,a=Xe(e);return V(()=>i(a,t,n),[t,i,n]),null}function vr(e){return _.useMemo(()=>Je(e),[e])}const ke=new WeakMap;function it(e,t){return function(n,...i){let a=ke.get(n);return a||(a=new n,ke.set(n,a)),e&&e(a),Promise.all(i.map(v=>new Promise((w,d)=>a.load(v,p=>{p.scene&&Object.assign(p,Je(p.scene)),w(p)},t,p=>d(new Error(`Could not load ${v}: ${p==null?void 0:p.message}`))))))}}function st(e,t,n,i){const a=Array.isArray(t)?t:[t],v=Pt(it(n,i),[e,...a],{equal:M.equ});return Array.isArray(t)?v:v[0]}st.preload=function(e,t,n){const i=Array.isArray(t)?t:[t];return St(it(n),[e,...i])};st.clear=function(e,t){const n=Array.isArray(t)?t:[t];return Mt([e,...n])};const U=new Map,{invalidate:De,advance:Fe}=Qt(U),{reconciler:W,applyProps:I}=qt(U,Xt),B={objects:"shallow",strict:!1},Zt=(e,t)=>{const n=typeof e=="function"?e(t):e;return tt(n)?n:new yt({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function er(e,t){const n=typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement;if(t){const{width:i,height:a,top:v,left:w,updateStyle:d=n}=t;return{width:i,height:a,top:v,left:w,updateStyle:d}}else if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:i,height:a,top:v,left:w}=e.parentElement.getBoundingClientRect();return{width:i,height:a,top:v,left:w,updateStyle:n}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0,updateStyle:n};return{width:0,height:0,top:0,left:0}}function at(e){const t=U.get(e),n=t==null?void 0:t.fiber,i=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const a=typeof reportError=="function"?reportError:console.error,v=i||Jt(De,Fe),w=n||W.createContainer(v,G.ConcurrentRoot,null,!1,null,"",a,null);t||U.set(e,{fiber:w,store:v});let d,p=!1,h;return{configure(r={}){let{gl:o,size:f,scene:c,events:l,onCreated:y,shadows:g=!1,linear:s=!1,flat:u=!1,legacy:m=!1,orthographic:E=!1,frameloop:C="always",dpr:P=[1,2],performance:x,raycaster:j,camera:O,onPointerMissed:S}=r,b=v.getState(),R=b.gl;b.gl||b.set({gl:R=Zt(o,e)});let k=b.raycaster;k||b.set({raycaster:k=new He});const{params:X,...Q}=j||{};if(M.equ(Q,k,B)||I(k,{...Q}),M.equ(X,k.params,B)||I(k,{params:{...k.params,...X}}),!b.camera||b.camera===h&&!M.equ(h,O,B)){h=O;const L=O instanceof bt,T=L?O:E?new lt(0,0,0,0,.1,1e3):new ut(75,0,.1,1e3);L||(T.position.z=5,O&&(I(T,O),("aspect"in O||"left"in O||"right"in O||"bottom"in O||"top"in O)&&(T.manual=!0,T.updateProjectionMatrix())),!b.camera&&!(O!=null&&O.rotation)&&T.lookAt(0,0,0)),b.set({camera:T}),k.camera=T}if(!b.scene){let L;c!=null&&c.isScene?L=c:(L=new ft,c&&I(L,c)),b.set({scene:N(L)})}if(!b.xr){var $;const L=(z,oe)=>{const ee=v.getState();ee.frameloop!=="never"&&Fe(z,!0,ee,oe)},T=()=>{const z=v.getState();z.gl.xr.enabled=z.gl.xr.isPresenting,z.gl.xr.setAnimationLoop(z.gl.xr.isPresenting?L:null),z.gl.xr.isPresenting||De(z)},H={connect(){const z=v.getState().gl;z.xr.addEventListener("sessionstart",T),z.xr.addEventListener("sessionend",T)},disconnect(){const z=v.getState().gl;z.xr.removeEventListener("sessionstart",T),z.xr.removeEventListener("sessionend",T)}};typeof(($=R.xr)==null?void 0:$.addEventListener)=="function"&&H.connect(),b.set({xr:H})}if(R.shadowMap){const L=R.shadowMap.enabled,T=R.shadowMap.type;if(R.shadowMap.enabled=!!g,M.boo(g))R.shadowMap.type=ie;else if(M.str(g)){var Z;const H={basic:vt,percentage:pt,soft:ie,variance:dt};R.shadowMap.type=(Z=H[g])!=null?Z:ie}else M.obj(g)&&Object.assign(R.shadowMap,g);(L!==R.shadowMap.enabled||T!==R.shadowMap.type)&&(R.shadowMap.needsUpdate=!0)}const D=We();D&&("enabled"in D?D.enabled=!m:"legacyMode"in D&&(D.legacyMode=m)),p||I(R,{outputEncoding:s?3e3:3001,toneMapping:u?ht:mt}),b.legacy!==m&&b.set(()=>({legacy:m})),b.linear!==s&&b.set(()=>({linear:s})),b.flat!==u&&b.set(()=>({flat:u})),o&&!M.fun(o)&&!tt(o)&&!M.equ(o,R,B)&&I(R,o),l&&!b.events.handlers&&b.set({events:l(v)});const F=er(e,f);return M.equ(F,b.size,B)||b.setSize(F.width,F.height,F.updateStyle,F.top,F.left),P&&b.viewport.dpr!==Ke(P)&&b.setDpr(P),b.frameloop!==C&&b.setFrameloop(C),b.onPointerMissed||b.set({onPointerMissed:S}),x&&!M.equ(x,b.performance,B)&&b.set(L=>({performance:{...L.performance,...x}})),d=y,p=!0,this},render(r){return p||this.configure(),W.updateContainer(A.jsx(tr,{store:v,children:r,onCreated:d,rootElement:e}),w,null,()=>{}),v},unmount(){ct(e)}}}function hr(e,t,n){console.warn("R3F.render is no longer supported in React 18. Use createRoot instead!");const i=at(t);return i.configure(n),i.render(e)}function tr({store:e,children:t,onCreated:n,rootElement:i}){return V(()=>{const a=e.getState();a.set(v=>({internal:{...v.internal,active:!0}})),n&&n(a),e.getState().events.connected||a.events.connect==null||a.events.connect(i)},[]),A.jsx(ye.Provider,{value:e,children:t})}function ct(e,t){const n=U.get(e),i=n==null?void 0:n.fiber;if(i){const a=n==null?void 0:n.store.getState();a&&(a.internal.active=!1),W.updateContainer(null,i,null,()=>{a&&setTimeout(()=>{try{var v,w,d,p;a.events.disconnect==null||a.events.disconnect(),(v=a.gl)==null||(w=v.renderLists)==null||w.dispose==null||w.dispose(),(d=a.gl)==null||d.forceContextLoss==null||d.forceContextLoss(),(p=a.gl)!=null&&p.xr&&a.xr.disconnect(),Vt(a),U.delete(e),t&&t(e)}catch{}},500)})}}function mr(e,t,n){return A.jsx(rr,{children:e,container:t,state:n},t.uuid)}function rr({state:e={},children:t,container:n}){const{events:i,size:a,...v}=e,w=_e(),[d]=_.useState(()=>new He),[p]=_.useState(()=>new Ie),h=_.useCallback((o,f)=>{const c={...o};Object.keys(o).forEach(y=>{(Kt.includes(y)||o[y]!==f[y]&&f[y])&&delete c[y]});let l;if(f&&a){const y=f.camera;l=o.viewport.getCurrentViewport(y,new J,a),y!==o.camera&&Ze(y,a)}return{...c,scene:n,raycaster:d,pointer:p,mouse:p,previousRoot:w,events:{...o.events,...f==null?void 0:f.events,...i},size:{...o.size,...a},viewport:{...o.viewport,...l},...v}},[e]),[r]=_.useState(()=>{const o=w.getState();return Be((c,l)=>({...o,scene:n,raycaster:d,pointer:p,mouse:p,previousRoot:w,events:{...o.events,...i},size:{...o.size,...a},...v,set:c,get:l,setEvents:y=>c(g=>({...g,events:{...g.events,...y}}))}))});return _.useEffect(()=>{const o=w.subscribe(f=>r.setState(c=>h(f,c)));return()=>{o()}},[h]),_.useEffect(()=>{r.setState(o=>h(w.getState(),o))},[h]),_.useEffect(()=>()=>{r.destroy()},[]),A.jsx(A.Fragment,{children:W.createPortal(A.jsx(ye.Provider,{value:r,children:t}),r,null)})}function gr(e){return W.flushSync(e,void 0)}W.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:_.version});const wr=_.unstable_act,ve={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function nr(e){const{handlePointer:t}=Yt(e);return{priority:1,enabled:!0,compute(n,i,a){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(ve).reduce((n,i)=>({...n,[i]:t(i)}),{}),update:()=>{var n;const{events:i,internal:a}=e.getState();(n=a.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(a.lastEvent.current)},connect:n=>{var i;const{set:a,events:v}=e.getState();v.disconnect==null||v.disconnect(),a(w=>({events:{...w.events,connected:n}})),Object.entries((i=v.handlers)!=null?i:[]).forEach(([w,d])=>{const[p,h]=ve[w];n.addEventListener(p,d,{passive:h})})},disconnect:()=>{const{set:n,events:i}=e.getState();if(i.connected){var a;Object.entries((a=i.handlers)!=null?a:[]).forEach(([v,w])=>{if(i&&i.connected instanceof HTMLElement){const[d]=ve[v];i.connected.removeEventListener(d,w)}}),n(v=>({events:{...v.events,connected:void 0}}))}}}}const or=_.forwardRef(function({children:t,fallback:n,resize:i,style:a,gl:v,events:w=nr,eventSource:d,eventPrefix:p,shadows:h,linear:r,flat:o,legacy:f,orthographic:c,frameloop:l,dpr:y,performance:g,raycaster:s,camera:u,scene:m,onPointerMissed:E,onCreated:C,...P},x){_.useMemo(()=>Nt(Et),[]);const j=Bt(),[O,S]=xt({scroll:!0,debounce:{scroll:50,resize:0},...i}),b=_.useRef(null),R=_.useRef(null);_.useImperativeHandle(x,()=>b.current);const k=Xe(E),[X,Q]=_.useState(!1),[$,Z]=_.useState(!1);if(X)throw X;if($)throw $;const D=_.useRef(null);V(()=>{const L=b.current;S.width>0&&S.height>0&&L&&(D.current||(D.current=at(L)),D.current.configure({gl:v,events:w,shadows:h,linear:r,flat:o,legacy:f,orthographic:c,frameloop:l,dpr:y,performance:g,raycaster:s,camera:u,scene:m,size:S,onPointerMissed:(...T)=>k.current==null?void 0:k.current(...T),onCreated:T=>{T.events.connect==null||T.events.connect(d?Gt(d)?d.current:d:R.current),p&&T.setEvents({compute:(H,z)=>{const oe=H[p+"X"],ee=H[p+"Y"];z.pointer.set(oe/z.size.width*2-1,-(ee/z.size.height)*2+1),z.raycaster.setFromCamera(z.pointer,z.camera)}}),C==null||C(T)}}),D.current.render(A.jsx(j,{children:A.jsx($e,{set:Z,children:A.jsx(_.Suspense,{fallback:A.jsx(Ut,{set:Q}),children:t??null})})})))}),_.useEffect(()=>{const L=b.current;if(L)return()=>ct(L)},[]);const F=d?"none":"auto";return A.jsx("div",{ref:R,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:F,...a},...P,children:A.jsx("div",{ref:O,style:{width:"100%",height:"100%"},children:A.jsx("canvas",{ref:b,style:{display:"block"},children:n})})})}),yr=_.forwardRef(function(t,n){return A.jsx(Ue,{children:A.jsx(or,{...t,ref:n})})});export{yr as Canvas,ar as ReactThreeFiber,U as _roots,wr as act,lr as addAfterEffect,cr as addEffect,ur as addTail,Fe as advance,I as applyProps,Je as buildGraph,ye as context,Yt as createEvents,nr as createPointerEvents,mr as createPortal,at as createRoot,Vt as dispose,nr as events,Nt as extend,K as flushGlobalEffects,gr as flushSync,Y as getRootState,De as invalidate,W as reconciler,hr as render,ct as unmountComponentAtNode,pr as useFrame,vr as useGraph,fr as useInstanceHandle,st as useLoader,_e as useStore,dr as useThree};
